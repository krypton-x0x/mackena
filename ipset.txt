üß† –ó–∞—á–µ–º –≤–æ–æ–±—â–µ –Ω—É–∂–µ–Ω ipset, –µ—Å–ª–∏ –µ—Å—Ç—å iptables?
–í iptables —Ç—ã –º–æ–∂–µ—à—å –ø–∏—Å–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞ —Ç–∏–ø–∞:

bash
Copy
Edit
iptables -A INPUT -s 1.2.3.4 -j DROP
iptables -A INPUT -s 5.6.7.8 -j DROP
–ù–æ –µ—Å–ª–∏ —É —Ç–µ–±—è 1000 IP-—à–Ω–∏–∫–æ–≤, —Ç—ã –ø–æ–ª—É—á–∞–µ—à—å 1000 –ø—Ä–∞–≤–∏–ª, –∫–æ—Ç–æ—Ä—ã–µ:

–∂—Ä—É—Ç –ø–∞–º—è—Ç—å

–≥—Ä—É–∑—è—Ç CPU

—Å–∏–ª—å–Ω–æ —Ç–æ—Ä–º–æ–∑—è—Ç –∑–∞–≥—Ä—É–∑–∫—É —Å–∏—Å—Ç–µ–º—ã

–ª–æ–º–∞—é—Ç –º–æ–∑–≥ –ø—Ä–∏ –æ—Ç–ª–∞–¥–∫–µ

ipset —Ä–µ—à–∞–µ—Ç —ç—Ç–æ –∫—Ä–∞—Å–∏–≤–æ.
–û–Ω —Å–æ–∑–¥–∞—ë—Ç –æ–¥–Ω—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É (—Å–µ—Ç), –≥–¥–µ –ª–µ–∂–∞—Ç –≤—Å–µ IP-—à–Ω–∏–∫–∏, –∏ iptables –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ —ç—Ç–æ–º—É —Å–µ—Ç—É, –∫–∞–∫ –∫ –æ–¥–Ω–æ–º—É —É—Å–ª–æ–≤–∏—é.

‚úä –û–¥–∏–Ω iptables ‚Äî –º–∏–ª–ª–∏–æ–Ω IP, –∫–∞–∫ –∞—Ä–º–∏—è –≤ –æ–¥–Ω–æ–º —â–∏—Ç–µ.

üöÄ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?
–¢—ã —Å–æ–∑–¥–∞—ë—à—å "—Å–µ—Ç" (–Ω–∞–ø—Ä–∏–º–µ—Ä, blacklist).

–ö–∏–¥–∞–µ—à—å —Ç—É–¥–∞ IP'—à–Ω–∏–∫–∏ –∏–ª–∏ –ø–æ–¥—Å–µ—Ç–∏.

–ü–æ–¥–∫–ª—é—á–∞–µ—à—å —ç—Ç–æ—Ç —Å–ø–∏—Å–æ–∫ –∫ iptables —á–µ—Ä–µ–∑ -m set.

–í—Å—ë: –æ–¥–Ω–æ –ø—Ä–∞–≤–∏–ª–æ –≤ iptables –æ—Ç—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞ —Ç—ã—Å—è—á–∏ –∞–¥—Ä–µ—Å–æ–≤.

bash
Copy
Edit
ipset create blacklist hash:ip
ipset add blacklist 123.45.67.89
iptables -I INPUT -m set --match-set blacklist src -j DROP
–¢–µ–ø–µ—Ä—å –ª—é–±–æ–π —Ç—Ä–∞—Ñ–∏–∫ –æ—Ç 123.45.67.89 –æ—Ç–ª–µ—Ç–∞–µ—Ç –≤ –±–∞–Ω, –±–µ–∑ –¥–æ–ø. –ø—Ä–∞–≤–∏–ª –≤ iptables.

üî• –ö–æ–≥–¥–∞ —ç—Ç–æ –Ω—É–∂–Ω–æ?
üåç DDoS-–∞—Ç–∞–∫–∏ ‚Äî –∑–∞ –º–∏–Ω—É—Ç—É –º–æ–∂–Ω–æ –∑–∞–±–∞–Ω–∏—Ç—å —Ç—ã—Å—è—á—É IP.

üåê –ë—Ä—É—Ç—Ñ–æ—Ä—Å —Å –±–æ—Ç–Ω–µ—Ç–æ–≤ ‚Äî –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≤–Ω–æ—Å–∏—Ç—å IP —Å fail2ban.

üß± –ì–µ–æ-–±–ª–æ–∫ ‚Äî –ø–æ–¥–∫–ª—é—á–∞–µ—à—å —Å–µ—Ç—ã —Å IP-–¥–∏–∞–ø–∞–∑–æ–Ω–∞–º–∏ —Å—Ç—Ä–∞–Ω.

‚ò†Ô∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞: –±–æ—Ç –∑–∞—à–µ–ª ‚Äî –±–∞–Ω, –∏ –≤ ipset.

üìä –ü–æ–¥ –∫–∞–ø–æ—Ç–æ–º
ipset —é–∑–∞–µ—Ç —Ö—ç—à-—Ç–∞–±–ª–∏—Ü—ã –≤ —è–¥—Ä–µ Linux:

–î–æ–±–∞–≤–ª–µ–Ω–∏–µ: O(1) (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ)

–ü—Ä–æ–≤–µ—Ä–∫–∞: O(1) (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ)

–†–∞–±–æ—Ç–∞ —Å –¥–µ—Å—è—Ç–∫–∞–º–∏ —Ç—ã—Å—è—á IP –Ω–µ —Ç–æ—Ä–º–æ–∑–∏—Ç —è–¥—Ä–æ

iptables –±–µ–∑ ipset –±—É–¥–µ—Ç –∏–¥—Ç–∏ –ø–æ —Å–ø–∏—Å–∫—É, –∫–∞–∫ –¥–µ–¥ —Å —Ç–µ–ª–µ–∂–∫–æ–π: –æ–¥–∏–Ω IP ‚Äî –æ–¥–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞. –≠—Ç–æ –∂–µ—Å—Ç—å, –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ –ø—Ä–∞–≤–∏–ª–∞ –≤ –Ω–∞—á–∞–ª–µ —Ü–µ–ø–æ—á–∫–∏.

üí£ –ü–æ—á–µ–º—É —ç—Ç–æ must-have –¥–ª—è DevOps?
–ü–æ—Ç–æ–º—É —á—Ç–æ DevOps ‚Äî —ç—Ç–æ –ø—Ä–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é –∏ –º–∞—Å—à—Ç–∞–±. –ê ipset:

–î–æ–±–∞–≤–ª—è–µ—Ç IP –Ω–∞ –ª–µ—Ç—É –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ iptables.

–õ–µ–≥–∫–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å fail2ban, csf, suricata, zabbix, –∫–µ–º —É–≥–æ–¥–Ω–æ.

–ü–æ–∑–≤–æ–ª—è–µ—Ç –¥–µ—Ä–∂–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –Ω–µ–∑–∞–≤–∏—Å–∏–º—É—é –æ—Ç iptables-–ø—Ä–∞–≤–∏–ª.

–ï—Å–ª–∏ –≤—Å—ë –µ—â—ë –Ω–µ —É–±–µ–¥–∏–ª ‚Äî –ø—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —Ç—ã —Ö–æ—á–µ—à—å –∑–∞–±–∞–Ω–∏—Ç—å:

–í—Å–µ TOR exit –Ω–æ–¥—ã.

–ö–∏—Ç–∞–π—Å–∫–∏–π —Ç—Ä–∞—Ñ–∏–∫.

–ë–æ—Ç–Ω–µ—Ç —Å 50,000 IP.

–¢—ã –Ω–µ –±—É–¥–µ—à—å –ø–∏—Å–∞—Ç—å 50,000 iptables -A ‚Äî —Ç—ã —Å–æ–∑–¥–∞—à—å –æ–¥–∏–Ω ipset, –∏ –±–∞–Ω –±—É–¥–µ—Ç –ª–µ—Ç–∞—Ç—å –∫–∞–∫ —Ä–∞–∫–µ—Ç